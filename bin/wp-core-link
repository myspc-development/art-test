#!/usr/bin/env bash
set -euo pipefail
: "${WP_CORE_DIR:?Set WP_CORE_DIR to an existing WP root (contains wp-settings.php)}"
TESTS_DIR="${WP_PHPUNIT__DIR:-vendor/wp-phpunit/wp-phpunit}"
mkdir -p "${TESTS_DIR}"
if [ ! -f "${WP_CORE_DIR}/wp-settings.php" ]; then
  echo "wp-settings.php not found in WP_CORE_DIR=${WP_CORE_DIR}" >&2
  exit 1
fi
rm -rf "${TESTS_DIR}/wordpress"
ln -s "${WP_CORE_DIR}" "${TESTS_DIR}/wordpress"
echo "Linked ${WP_CORE_DIR} -> ${TESTS_DIR}/wordpress"
